<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Listado de Inventarios | StockGuardian</title>
  <link rel="stylesheet" href="listado.css" />
</head>
<body>
  <div class="listado-container">
    <!-- Panel -->
    <div class="panel">
      <div class="volver" onclick="window.location.href='seleccion_usuario.html'">&#10094;</div>
      <h1 class="titulo">Tus Inventarios</h1>

      <!-- Tabla de Inventarios -->
      <div class="tabla">
        <div class="fila encabezado">
          <span>Nombre</span>
          <span>ID</span>
          <span>Últ. Modificación</span>
          <span>Acciones</span>
        </div>

        <div class="fila">
          <span>Llantas y Más</span>
          <span>45TYUY64XS <button onclick="copiarID('45TYUY64XS')">📋</button></span>
          <span>24/03/2025</span>
          <span><button class="eliminar-btn" onclick="mostrarConfirmacion('45TYUY64XS')">🗑️</button></span>
        </div>

        <div class="fila">
          <span>Latosos co</span>
          <span>982TE76HB1 <button onclick="copiarID('982TE76HB1')">📋</button></span>
          <span>30/03/2025</span>
          <span><button class="eliminar-btn" onclick="mostrarConfirmacion('982TE76HB1')">🗑️</button></span>
        </div>
      </div>
    </div>

    <!-- Modal de Confirmación -->
    <div class="modal-overlay" id="modal">
      <div class="modal">
        <p><strong>¿Estás seguro de querer eliminar permanentemente este inventario?</strong></p>
        <img src="triste.png" alt="Imagen" class="imagen-modal">
        <div class="botones">
          <button onclick="confirmarEliminacion()">Confirmar</button>
          <button onclick="cerrarModal()">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let idAEliminar = "";

    function copiarID(id) {
      navigator.clipboard.writeText(id);
      alert(`ID ${id} copiado al portapapeles`);
    }

    function mostrarConfirmacion(id) {
      idAEliminar = id;
      document.getElementById("modal").style.display = "flex";
    }

    function cerrarModal() {
      document.getElementById("modal").style.display = "none";
      idAEliminar = "";
    }

    function confirmarEliminacion() {
      alert(`El inventario con ID ${idAEliminar} ha sido eliminado (simulado).`);
      cerrarModal();
    }

    document.addEventListener("DOMContentLoaded", function() {
      async function cargarInventarios() {
      const creadorID = localStorage.getItem.idUsuario;

      const host = window.location.hostname;
      const response = await fetch(`http://${host}:3000/datosinventario?creadorID=${creadorID}`);
      const data = await response.json();

      if (response.ok) {
        const inventarios = data.inventarios;
        
        //Agregar los inventarios a la lista
        const tabla = document.querySelector(".tabla");
        inventarios.forEach(inventario => {
          const fila = document.createElement("div");
          fila.classList.add("fila");

          fila.innerHTML = `
            <span>${inventario.Nombre}</span>
            <span>${inventario.ID_Inventario} <button onclick="copiarID('${inventario.ID_Inventario}')">📋</button></span>
            <span>${inventario.FechaModificacion || "No disponible"}</span>
            <span><button class="eliminar-btn" onclick="mostrarConfirmacion('${inventario.ID_Inventario}')">🗑️</button></span>
          `;
          
          tabla.appendChild(fila);
        });
      } else {
        alert(data.mensaje || "Error al cargar inventarios.");
      }
      }

      cargarInventarios();
    });

  </script>
</body>
</html>
